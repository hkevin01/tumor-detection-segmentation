{
  "model": {
    "architecture": "unetr",
    "in_channels": 4,
    "out_channels": 3,
    "img_size": [128, 128, 128],
    "feature_size": 16,
    "hidden_size": 768,
    "mlp_dim": 3072,
    "num_heads": 12,
    "pos_embed": "perceptron",
    "norm_name": "instance",
    "dropout_rate": 0.1
  },
  "optimizer": {
    "type": "AdamW",
    "lr": 0.0001,
    "betas": [0.9, 0.999],
    "eps": 1e-08,
    "weight_decay": 0.01,
    "amsgrad": false
  },
  "scheduler": {
    "type": "ReduceLROnPlateau",
    "mode": "max",
    "factor": 0.5,
    "patience": 5,
    "threshold": 0.0001,
    "threshold_mode": "abs",
    "cooldown": 2,
    "min_lr": 1e-07,
    "verbose": true
  },
  "training": {
    "batch_size": 2,
    "num_epochs": 100,
    "val_interval": 1,
    "grad_clip": 1.0,
    "early_stopping_patience": 15,
    "use_amp": true,
    "num_workers": 4,
    "prefetch_factor": 2
  },
  "loss": {
    "type": "DiceCELoss",
    "dice_weight": 0.5,
    "ce_weight": 0.5,
    "include_background": false,
    "softmax": true,
    "to_onehot_y": true,
    "squared_pred": false
  },
  "metrics": {
    "dice": {
      "include_background": false,
      "reduction": "mean_batch",
      "get_not_nans": false
    },
    "hausdorff": {
      "include_background": false,
      "percentile": 95
    }
  },
  "augmentation": {
    "spatial_prob": 0.2,
    "intensity_prob": 0.15,
    "flip_prob": 0.5
  }
}
